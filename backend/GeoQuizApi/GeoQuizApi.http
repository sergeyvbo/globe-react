@GeoQuizApi_HostAddress = http://localhost:5000

# Variables for testing
@testEmail = testhttp@example.com
@testPassword = TestPassword123
@testName = Test User

@jwtToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJuYW1laWQiOiJhZGIxMGIwYi1iOTNlLTRmODUtYjFhZi1lZTViOWU2MDJiMGIiLCJlbWFpbCI6InRlc3RodHRwQGV4YW1wbGUuY29tIiwianRpIjoiMmVlODQzMTItYjFjNi00Y2U1LTkxYzYtMjZhZTExMjlkYjZkIiwidW5pcXVlX25hbWUiOiJVcGRhdGVkIFRlc3QgVXNlciIsIm5iZiI6MTc1MzgwMzU2OSwiZXhwIjoxNzUzODA0NDY5LCJpYXQiOjE3NTM4MDM1NjksImlzcyI6Ikdlb1F1aXpBcGkiLCJhdWQiOiJHZW9RdWl6Q2xpZW50In0.Pt_3ihMi6EzQcPZ1QhXCLJdUVcRjsPT_iV_Cl5Vr7YE
@refreshToken = xO9tHx3sFwjrwbNr1qAj+C2oi7EWJfqCx8Z/jd/2LDkr+mtBId/pPA5k5tmii/0Y0DCua18G756iv8FnkzUMHw==

### 0. Test API connectivity
GET {{GeoQuizApi_HostAddress}}/api/auth/test
Accept: application/json

###
GET {{GeoQuizApi_HostAddress}}/health
###
GET {{GeoQuizApi_HostAddress}}/health/detailed

### 1. Register a new user
POST {{GeoQuizApi_HostAddress}}/api/auth/register
Content-Type: application/json

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}",
  "name": "{{testName}}"
}

### 2. Login with the registered user
POST {{GeoQuizApi_HostAddress}}/api/auth/login
Content-Type: application/json

{
  "email": "{{testEmail}}",
  "password": "{{testPassword}}"
}

### 3. Get current user info (requires valid JWT token)
# Replace YOUR_JWT_TOKEN with the accessToken from login/register response
GET {{GeoQuizApi_HostAddress}}/api/auth/me
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 4. Update user profile (requires valid JWT token)
PUT {{GeoQuizApi_HostAddress}}/api/auth/profile
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "name": "Updated Test User",
  "avatar": "https://example.com/avatar.jpg"
}

### 5. Change password (requires valid JWT token)
PUT {{GeoQuizApi_HostAddress}}/api/auth/change-password
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "currentPassword": "{{testPassword}}",
  "newPassword": "NewPassword123"
}

### 5.1 Change password back
PUT {{GeoQuizApi_HostAddress}}/api/auth/change-password
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "currentPassword": "NewPassword123",
  "newPassword": "{{testPassword}}"
}

### 6. Refresh token
# Replace YOUR_REFRESH_TOKEN with the refreshToken from login/register response
POST {{GeoQuizApi_HostAddress}}/api/auth/refresh
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### 7. Logout (requires valid JWT token and refresh token)
POST {{GeoQuizApi_HostAddress}}/api/auth/logout
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "refreshToken": "{{refreshToken}}"
}

### 8. Test invalid login
POST {{GeoQuizApi_HostAddress}}/api/auth/login
Content-Type: application/json

{
  "email": "invalid@example.com",
  "password": "wrongpassword"
}

### 9. Test registration with existing email
POST {{GeoQuizApi_HostAddress}}/api/auth/register
Content-Type: application/json

{
  "email": "{{testEmail}}",
  "password": "AnotherPassword123",
  "name": "Another User"
}

### 10. Test registration with invalid email
POST {{GeoQuizApi_HostAddress}}/api/auth/register
Content-Type: application/json

{
  "email": "invalid-email",
  "password": "{{testPassword}}",
  "name": "Test User"
}

### 11. Test registration with weak password
POST {{GeoQuizApi_HostAddress}}/api/auth/register
Content-Type: application/json

{
  "email": "weak@example.com",
  "password": "123",
  "name": "Weak Password User"
}

### 12. Test accessing protected endpoint without token
GET {{GeoQuizApi_HostAddress}}/api/auth/me
Accept: application/json

### 13. Test with expired/invalid token
GET {{GeoQuizApi_HostAddress}}/api/auth/me
Authorization: Bearer invalid.jwt.token
Accept: application/json

### === GAME STATS ENDPOINTS ===

### 14. Save a game session (requires valid JWT token)
POST {{GeoQuizApi_HostAddress}}/api/game-stats
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "gameType": "countries",
  "correctAnswers": 8,
  "wrongAnswers": 2,
  "sessionStartTime": "2025-01-20T10:00:00Z",
  "sessionEndTime": "2025-01-20T10:05:30Z"
}

### 15. Save another game session - flags
POST {{GeoQuizApi_HostAddress}}/api/game-stats
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "gameType": "flags",
  "correctAnswers": 15,
  "wrongAnswers": 5,
  "sessionStartTime": "2025-01-20T11:00:00Z",
  "sessionEndTime": "2025-01-20T11:08:45Z"
}

### 16. Save another game session - states
POST {{GeoQuizApi_HostAddress}}/api/game-stats
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "gameType": "states",
  "correctAnswers": 12,
  "wrongAnswers": 3,
  "sessionStartTime": "2025-01-20T12:00:00Z",
  "sessionEndTime": "2025-01-20T12:06:15Z"
}

### 17. Get user's aggregated statistics (requires valid JWT token)
GET {{GeoQuizApi_HostAddress}}/api/game-stats/me
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 18. Get user's game history (requires valid JWT token)
GET {{GeoQuizApi_HostAddress}}/api/game-stats/me/history
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 19. Get user's game history with pagination
GET {{GeoQuizApi_HostAddress}}/api/game-stats/me/history?page=1&pageSize=5
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 20. Migrate anonymous progress (requires valid JWT token)
POST {{GeoQuizApi_HostAddress}}/api/game-stats/migrate
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "anonymousSessions": [
    {
      "gameType": "countries",
      "correctAnswers": 6,
      "wrongAnswers": 4,
      "sessionStartTime": "2025-01-19T15:00:00Z",
      "sessionEndTime": "2025-01-19T15:04:30Z"
    },
    {
      "gameType": "flags",
      "correctAnswers": 9,
      "wrongAnswers": 1,
      "sessionStartTime": "2025-01-19T16:00:00Z",
      "sessionEndTime": "2025-01-19T16:03:45Z"
    }
  ]
}

### 21. Test saving game session with invalid data
POST {{GeoQuizApi_HostAddress}}/api/game-stats
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "gameType": "",
  "correctAnswers": -1,
  "wrongAnswers": -2,
  "sessionStartTime": "2025-01-20T10:00:00Z"
}

### 22. Test accessing game stats without authentication
GET {{GeoQuizApi_HostAddress}}/api/game-stats/me
Accept: application/json

### 23. Test migrating empty anonymous sessions
POST {{GeoQuizApi_HostAddress}}/api/game-stats/migrate
Authorization: Bearer {{jwtToken}}
Content-Type: application/json

{
  "anonymousSessions": []
}
### =
== LEADERBOARD ENDPOINTS ===

### 24. Get global leaderboard (all players, all game types, all time)
GET {{GeoQuizApi_HostAddress}}/api/leaderboard
Accept: application/json

### 25. Get global leaderboard with pagination
GET {{GeoQuizApi_HostAddress}}/api/leaderboard?page=1&pageSize=10
Accept: application/json

### 26. Get global leaderboard with current user position (requires JWT token)
GET {{GeoQuizApi_HostAddress}}/api/leaderboard
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 27. Get leaderboard filtered by game type - countries
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/game-type/countries
Accept: application/json

### 28. Get leaderboard filtered by game type - flags
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/game-type/flags
Accept: application/json

### 29. Get leaderboard filtered by game type - states
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/game-type/states
Accept: application/json

### 30. Get leaderboard filtered by time period - week
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/period/week
Accept: application/json

### 31. Get leaderboard filtered by time period - month
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/period/month
Accept: application/json

### 32. Get leaderboard filtered by time period - year
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/period/year
Accept: application/json

### 33. Get leaderboard filtered by time period - all-time
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/period/all-time
Accept: application/json

### 34. Get leaderboard with combined filters (game type + period)
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/filtered?gameType=countries&period=week
Accept: application/json

### 35. Get leaderboard with combined filters and pagination
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/filtered?gameType=flags&period=month&page=1&pageSize=5
Accept: application/json

### 36. Get leaderboard with only game type filter using filtered endpoint
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/filtered?gameType=countries
Accept: application/json

### 37. Get leaderboard with only period filter using filtered endpoint
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/filtered?period=week
Accept: application/json

### 38. Get leaderboard with current user position using filtered endpoint (requires JWT token)
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/filtered?gameType=countries&period=week
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 39. Get available game types for filtering
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/game-types
Accept: application/json

### 40. Get available time periods for filtering
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/periods
Accept: application/json

### 41. Clear leaderboard cache (requires authentication)
POST {{GeoQuizApi_HostAddress}}/api/leaderboard/clear-cache
Authorization: Bearer {{jwtToken}}
Accept: application/json

### 42. Test invalid game type
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/game-type/invalid
Accept: application/json

### 43. Test invalid time period
GET {{GeoQuizApi_HostAddress}}/api/leaderboard/period/invalid
Accept: application/json

### 44. Test invalid pagination parameters
GET {{GeoQuizApi_HostAddress}}/api/leaderboard?page=0&pageSize=200
Accept: application/json

### 45. Test cache clearing without authentication
POST {{GeoQuizApi_HostAddress}}/api/leaderboard/clear-cache
Accept: application/json

### 46. Test leaderboard with maximum page size
GET {{GeoQuizApi_HostAddress}}/api/leaderboard?pageSize=100
Accept: application/json

### 47. Test leaderboard with minimum page size
GET {{GeoQuizApi_HostAddress}}/api/leaderboard?pageSize=1
Accept: application/json